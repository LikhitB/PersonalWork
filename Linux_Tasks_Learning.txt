Creating a user in non-interactive shell
=============================================

sudo useradd -s /bin/false javed

useradd → creates a new user.

-s → sets the user’s login shell.

/bin/false → non-interactive shell (immediately exits, no login/SSH). [ /usr/sbin/nologin or /sbin/nologin also works if present ]

Used for service/automation accounts where shell access is not needed.

Verify: grep javed /etc/passwd (check assigned shell).


Creating a Temporary User (Expiry Date)
===========================================

Use -e with useradd to set expiry:
sudo useradd -e 2025-12-31 javed

For an existing user, use chage:
sudo chage -E 2025-12-31 javed

-e / -E = account expiration date (YYYY-MM-DD format).

After expiry, the account is locked and cannot log in.

Check expiry details: sudo chage -l javed.

Disabling the ssh root login for servers and importance of etc/ssh
===================================================================

SSH Configuration Folder

SSH server settings are stored in:
/etc/ssh/

Main configuration file:
/etc/ssh/sshd_config

Lines starting with # are comments (ignored by SSH).

To disable root login, edit the file:

PermitRootLogin no


After changes, restart SSH service:

sudo systemctl restart sshd


Keep a backup before editing:

sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak

===================================================================

-> in order to execute the file the user must have the read permission also.

===================================================================

SELinux = Security-Enhanced Linux

Provides Mandatory Access Control (MAC) at kernel level

Works in addition to normal Linux permissions (chmod, chown)

Access is controlled by security policies
Based on labels (contexts), not users
eg -> user:role:type:level
sudo dnf install -y selinux-policy selinux-policy-targeted policycoreutils  -> for installing SELinux
sestatus              # detailed status
getenforce            # current mode
setenforce 0|1        # permissive / enforcing (temporary)
ls -Z                 # view SELinux context

=====================================================================
sudo passwd root  -> changes the password of the root
su - -> switch user to root


CRON JOB
=====================================================================
pattern of the time

check cat /etc/crontab
sudo crontab -e  -> edit the root's cron tab
sudo crontab -u likhit -e  -> edit the likhit's cron tab


Minute  Hour  DayOfMonth  Month  DayOfWeek   Command
30      6     *           *      3           echo<hello    -> cronjob for every Wednesday 6:30 am
0       21    27           2     *           echo>hello world  -> cronjob for every 27th day of February at 9:00


Install cron service: sudo yum install -y cronie
Start cron daemon: sudo systemctl start crond
Enable cron at boot: sudo systemctl enable crond
Check cron status: sudo systemctl status crond
Edit root cron jobs: sudo crontab -e
List root cron jobs: sudo crontab -l
Example cron entry (every 5 minutes): */5 * * * * /bin/echo hello > /tmp/cron_text
Cron directories: /etc/cron.hourly, /etc/cron.daily, /etc/cron.weekly, /etc/cron.monthly
System cron files location: /etc/cron.d/
Cron main config file: /etc/crontab
Cron log file: /var/log/cron
View cron logs (systemd): journalctl -u crond
Make script executable: chmod +x script.sh
Recommended script location: /usr/local/bin/
Verify cron output file: cat /tmp/cron_text

getting the usage of the cpu 

 df -H | awk '{print $5 " " $1}' | cut -d % -f 2   -> only gives numbers check one by one.

======================================================================

downloading pem keys before ssh

/mnt/c/Users/VLIKHBA/Downloads/MyPem.pem     -> its the wsl folders where the folders/files stored in windows are stored in /mnt

so mv /mnt/c/Users/VLIKHBA/Downloads/MyPem.pem ~/ -> move them to ~/ directory

then chmod 600 MyPem.pem

ssh ec2-user@ipaddress

======================================================================
Ansible 
=======

adhoc jobs example
------------------
ansible -i inventory all -m "shell" -a "touch devopsclasses" -> creates the devopsclass file in the target ipaddress mentioned in "inventory" file

apply only for ips present in the webserver folders
ansible -i inventory webservers -m "shell" -a "touch devopsclasses" -> creates the devopsclass file in the target ipaddress mentioned in "inventory" file

then the inventory file looks like 
[webserver]
list of ips  -> only these will be touched

[dbservers]
list of ips

ansible-playbook -i inventory my_first.yml  -> example to run the playbook

the playbook or yml file looks like(for starting the ngnix server of the target server ]
---
- name: first playbook for installing a module
  hosts: all
  become: true

  tasks:
    - name: install nginx
      apt:
        name: nginx
        state: present
    - name: start nginx
      service:
        name: nginx
        state: stopped

Ansible roles
we use ansible-galaxy to create roles

==============================================================
yum installs OS-managed packages that are stable but often outdated, while pip3 installs Python-managed packages directly from PyPI, allowing precise version control and faster updates. That is why pip3 is preferred in automation labs and modern DevOps workflows.

RHEL/CentOS separates system Python packages and user-installed packages.
System PATH for root sometimes doesn’t include /usr/local/bin (only /usr/bin and /bin).

yum install python3-pip -y
pip3 install ansible==4.7.0

python3 -m pip show ansible -> before updating the path variables(Location: /usr/local/lib/python3.9/site-packages)

If you just want Ansible globally and don’t care about 4.7.0 specifically, use dnf/yum install ansible.
If you must use 4.7.0, pip is the easiest, but you need to ensure the executable is in PATH (like we did).

==============================================================
root level path
---------------------
- importance of /

/
├── home
│   └── banner
│       └── backup (if we put command ls backup)
├── etc
├── var
├── backup   ← THIS is where your file went  (if we put command, ls /backup)
============================================================
Secure copy
------------

scp /backup/xfusioncorp_official.zip clint@stbkp01:/backup/   
- present the file is in banner server gts moved to clint backup folder.

-when we use scp we need to to do ssh-keygen and ssh-copy-id for automation purpose.
============================================================

| DIRECTORY | PURPOSE / MEANING                  | COMMON EXAMPLES / WHAT YOU STORE THERE |
| --------- | ---------------------------------- | -------------------------------------- |
| /         | Root of filesystem                 | Everything starts here                 |
| /bin      | Essential user commands            | ls, cp, mv, cat, rm                    |
| /sbin     | System administration commands     | reboot, shutdown, mount                |
| /etc      | System configuration files         | sshd_config, fstab, passwd             |
| /home     | Home directories for users         | /home/ec2-user, /home/john             |
| /root     | Home directory for root user       | Root user's personal files             |
| /tmp      | Temporary files (auto-cleaned)     | Installers, downloads                  |
| /var      | Variable data (changes frequently) | logs, cache, databases                 |
| /var/log  | System & application logs          | messages, secure, httpd logs           |
| /var/www  | Web server root                    | html files, websites                   |
| /usr      | Installed software & libraries     | java, git, python                      |
| /usr/bin  | User commands (non-essential)      | vim, curl, wget                        |
| /usr/lib  | Libraries for programs             | .so files                              |
| /opt      | Optional / third-party software    | tomcat, oracle, sonarqube              |
| /boot     | Bootloader & kernel files          | grub, vmlinuz                          |
| /dev      | Device files                       | sda, null, tty                         |
| /proc     | Process & kernel info (virtual)    | cpuinfo, meminfo                       |
| /sys      | Hardware & kernel interface        | system devices info                    |
| /run      | Runtime process data               | pid files, sockets                     |
| /media    | Auto-mounted removable media       | USB drives                             |
| /mnt      | Manual mount point                 | temporary mounts                       |


| TASK                    | WHERE TO LOOK |
| ----------------------- | ------------- |
| Edit configuration      | /etc          |
| Check logs              | /var/log      |
| Store temporary files   | /tmp          |
| Install custom software | /opt          |
| User personal files     | /home         |
| Web application files   | /var/www      |


| SCENARIO               | CORRECT PATH         |
| ---------------------- | -------------------- |
| Download Tomcat ZIP    | /tmp                 |
| Install Tomcat         | /opt/tomcat          |
| Apache website files   | /var/www/html        |
| SSH configuration      | /etc/ssh/sshd_config |
| Check system errors    | /var/log/messages    |
| User uploads/documents | /home/username       |


| ONE-LINE MEMORY TRICK | MEANING              |
| --------------------- | -------------------- |
| /etc                  | configuration        |
| /var                  | logs & changing data |
| /opt                  | applications         |
| /tmp                  | temporary            |
| /home                 | users                |


| Command     | Meaning                                                         |
| ----------- | --------------------------------------------------------------- |
| `su -`      | Switch to root **using root password**                          |
| `sudo su -` | Switch to root **using your own user password** (if authorized) |

=====================================================================
Networking Concepts
---------------------

netstat-> shows the connected ips in a list
telnet -> shows the connection
ping  -> shows the packet transfer
ipTbales
-consist of 
 - input chain -> chains shows the incoming packets
 - output chain -> chain shows the outgoing of the packets
 - forward chain -> to forward packet from source to destination
 - targets -> ACCEPT,REJECT,DROP
 - installing the ipTbales
    - sudo yum install iptables-services -y
    - sudo systemctl start iptables
    - sudo systemctl enable iptables
 -making it persistant even server is reboot
    sudo service iptables save
    cat /etc/sysconfig/iptables
    sudo reboot
    sudo iptables -L -n    -> rule must exist even after reboot
 - commands related to it
   - iptables -F  -> flush all tables
   - iptables -L -> list all ip tables
   - iptables -L --line-numbers-> list all ip tables with line numbers
   - iptables --policy INPUT ACCEPT  
     - INPUT -> chain
     - ACCEPT -> accept or reject or drop
   - iptables -I INPUT -s 10.0.0.1 -j DROP   -> -I means inserts , -s source ip , -j means target as DROP -> target of the input chain
   - iptables -A INPUT -s 10.0.0.1 -j DROP   ->-A means append
   - difference bw I and A is insert add the rule at top of the row and append adds to the bottom most.
   - iptables -D INPUT "linenumber" -> -D -> deletes the chain rule
   - iptables -I INPUT -p tcp --dport 22 -j ACCEPT-> allows port 22
   - iptables -I INPUT -p tcp --dport 22 -s 10.0.0.1/24 -j ACCEPT  -> allows 22 port req from that source ip only
   - sudo /sbin/iptables-save -> saves iptables in sbin
   - /sbin = System binaries
   - /bin = Binary commands needed by normal users
traceroute -> used to trace the route of the requests and response
mtr(my traceroute) -> pings,traces packets and shows routes
telnet -> used to connect to ips using port numbers
ip address show
iwconfig -> used to check the details of wireless connection
curl -X GET "" | jq
jq -> used to format the response of curls














